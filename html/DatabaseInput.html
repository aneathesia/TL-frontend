<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>InputData</title>
</head>
<script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
<link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />

<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../config.js"></script>
<body>
<div style="display: inline-block">
    <label id="note"></label>
    <select id="DataSelect" style="max-height: 20px"></select>
</div>

<div id = "DataContent" class="jexcel_content" style="overflow-y: auto;box-shadow: rgb(221, 221, 221) 2px 2px 2px 2px;"></div>


<div class="layui-layer-btn" style="display: flex;justify-content: space-around;">
    <button class="layui-layer-btn layui-layer-close"  onclick="setData()">确定</button>
    <button class="layui-layer-btn layui-btn-primary"  onclick="exitSet()">取消</button>
</div>
</body>



<script>
    let index = parent.layer.getFrameIndex(window.name);
    var voltageHeader = ['Elc110kV','Elc220kV','Elc330kV','Elc500kV','Direct500kV','Elc750kV','Direct800','Elc1000kV'];
    var Datatable = jspreadsheet(document.getElementById('DataContent'),{
        columns:[
            {type:"text",title:"参数名称",width: 100, name: "name"},
            {type:"text",title:"参数数值",width: 100, name: "value"}],
        editable: false
    })
    Datatable.hideIndex();

    var crossSample= [];
    // var conductor = [{'name':'电线型号','value':''},
    //     {'name':'截面积(mm²)','value':0},
    //     {'name':'外径(mm)','value':0},
    //     {'name':'重量kg/km','value':0},
    //     {'name':'弹性系数(kg)','value':0},
    //     {'name':'弹性系数(N)','value':0},
    //     {'name':'线膨胀系数','value':0},
    //     {'name':'断应力kgmm','value':0},
    //     {'name':'拉断力N','value':0},
    //     {'name':'导线1地线2','value':0},
    //     {'name':'标称截面','value':''}];
    var conductorSample = [{'name':'导地线类型','value':'导线'},
        {'name':'导地线截面积(mm²)','value':0},
        {'name':'导地线直径','value':0},
        {'name':'计算拉断力','value':0},
        {'name':'单位长度质量(kg/m)','value':0},
        {'name':'弹性系数(N/mm²)','value':0},
        {'name':'膨胀系数/℃','value':0},
        {'name':'导线分裂数','value':0}];
    var weatherSample=[];
    var towerSample =[];


    $("#DataSelect").change(function () {
        let res = $("#DataSelect").find("option:selected").text();
        console.log(encodeURI(res));
        let noteContent = $("#note").text();
        console.log("noteContent",noteContent);
        switch ($("#note").text()){
            //tcross
            case "交叉跨越":
                {
                    var sel = this.value;
                    console.log($("#DataSelect").get(0).selectedIndex);
                $.ajax({
                    url: BASEURL+"/tl/tcross/"+voltageHeader[sel], //提交的路径
                    type: "get",
                    //async: false,
                    success: function (data){
                        crossSample =[];
                        for(let i=0;i<data.length;i++){
                            var temp = Object.values(data[i]);
                            crossSample.push({'contabbr':temp[1],'voltage':temp[0]});
                        }
                        console.log(crossSample);

                    },
                    error:function (error) {
                        console.log(error);
                    }
                })
            }
            break;
            //conductor
            case "电线型号":
                {
                $.ajax({
                    url: BASEURL+"/tl/conductor/Search?Name="+encodeURI(res), //提交的路径
                    type: "get",
                    //async: false,
                    success: function (data){
                        console.log(data,data[0]);

                    },
                    error:function (error) {
                        console.log(error);
                    }
                })
            }
            break;
            //weather
            case "气象区":
                {
                $.ajax({
                    url: BASEURL+"/tl/weather/Search?Nameqxq="+encodeURI(res), //提交的路径
                    type: "get",
                    //async: false,
                    success: function (data){
                        console.log(data,data[0]);
                        weatherSample = [];
                        for(let j = 0 ; j<data[0].length;j++){
                            var row = {};
                            var para = Object.values(data[0][j]).split(",");
                            console.log(para);
                            row.name = "";
                            row.wd= para[0];
                            row.fs= para[1];
                            row.fb= para[2];
                            weatherSample.push(row);
                        }
                        console.log(weatherSample);
                    },
                    error:function (error) {
                        console.log(error);
                    }
                })
            }
            break;
            //tower
            case "杆塔类型":
                {
                $.ajax({
                    url: BASEURL+"/tl/tower/Search?Name="+encodeURI(res), //提交的路径
                    type: "get",
                    //async: false,
                    success: function (data){
                        console.log(data,data[0]);

                    },
                    error:function (error) {
                        console.log(error);
                    }
                })
            }
            break;
            default:
                break;
        }


    })

    function setData() {

    }

    function exitSet() {
        parent.layer.close(index);
    }

</script>

</html>