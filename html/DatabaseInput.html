<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>InputData</title>
</head>
<script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
<link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />

<script src="https://jsuites.net/v4/jsuites.js"></script>
<link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />
<script type="text/javascript" src="../lib/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="../config.js"></script>
<body>
<div style="display: inline-block">
    <label id="note"></label>
    <select id="DataSelect" style="max-height: 50px"></select>
</div>
<div id = "DataContent" class="jexcel_content" style="overflow-y: auto;height:40%;box-shadow: rgb(221, 221, 221) 2px 2px 2px 2px;"></div>

<div class="layui-layer-btn" style="display: flex;justify-content: space-around;">
    <button class="layui-layer-btn layui-layer-close"  >确定</button>
    <button class="layui-layer-btn layui-btn-primary"  >取消</button>
</div>
</body>



<script>

    var Datatable = jspreadsheet(document.getElementById('DataContent'),{
        columns:[
            {type:"text",title:"参数名称",width: 100, name: "name"},
            {type:"text",title:"参数数值",width: 100, name: "value"}],
        editable: false
    })
    Datatable.hideIndex();

    var conductor = [{'name':'电线型号','value':''},
        {'name':'截面积(mm²)','value':0},
        {'name':'外径(mm)','value':0},
        {'name':'重量kg/km','value':0},
        {'name':'弹性系数(kg)','value':0},
        {'name':'弹性系数(N)','value':0},
        {'name':'线膨胀系数','value':0},
        {'name':'断应力kgmm','value':0},
        {'name':'拉断力N','value':0},
        {'name':'导线1地线2','value':0},
        {'name':'标称截面','value':''}];

    $("#DataSelect").change(function () {
        let res = $("#DataSelect").find("option:selected").text();
        console.log(encodeURI(res));

        $.ajax({
            url: BASEURL+"/tl/conductor/Search?Name="+encodeURI(res), //提交的路径
            type: "get",
            //async: false,
            success: function (data){
                console.log(data,data[0]);
                conductor[0].value = data[0].name;
                conductor[1].value = data[0].a;
                conductor[2].value = data[0].d;
                conductor[3].value = data[0].p1;
                conductor[4].value = data[0].ekg;
                conductor[5].value = data[0].en;
                conductor[6].value = data[0].ac;
                conductor[7].value = data[0].tpkg;
                conductor[8].value = data[0].tpn;
                conductor[9].value = data[0].type;
                conductor[10].value = data[0].stda;

                Datatable.setData(conductor);

            },
            error:function (error) {
                console.log(error);
            }
        })
    })

</script>

</html>